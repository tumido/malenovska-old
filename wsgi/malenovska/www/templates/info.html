{% extends "base.html" %}
{% block imports %}
{{ block.super }}
<script type="text/javascript" src="//api.mapy.cz/loader.js"></script>
<script type="text/javascript">Loader.load();</script>
{% endblock imports %}
{% block content %}
<div class='container bg'>
  <div class='row'>
    <h1 class='page-header'>Důležité informace</h1>
      <div class='col-md-6'>
        {{ info_general|safe }}
      </div>
      <div class='col-md-6 pad-bottom'>
        {% for datum in dates %}
        <div class='row'>
          <div class="panel panel-horizontal panel-default">
            <div class="panel-body">{{datum.date}}
            </div>
            <div class="panel-heading">{{datum.name}}
            </div>
          </div>
        </div>
        {% endfor %}
        {% for text in texts%}
        <div class='row'>
          <div class="panel panel-horizontal panel-default">
            <div class="panel-body">{{text.text}}
            </div>
            <div class="panel-heading">{{text.name}}
            </div>
          </div>
        </div>
        {% endfor %}
      </div>
  </div>
</div>
<div class='container bg'>
  <div class='row'>
    <h1 class='page-header'>Mapa</h1>
    {{ info_map|safe }}
  </div>
  <div id="map"></div>
  <script>
    var m = new SMap(JAK.gel("map"));
    m.addDefaultLayer(SMap.DEF_BASE).enable();
    m.addDefaultControls();
    var data = {{ map_points|safe}};
    var points = [];
    var coords = [];
    var char = 65;

    for (var name in data) {
        var c = SMap.Coords.fromWGS84(data[name]);

        var znacka = JAK.mel("div");
        var obrazek = JAK.mel("img", {src:SMap.CONFIG.img+"/marker/drop-red.png"});
        znacka.appendChild(obrazek);
        var popisek = JAK.mel("div", {}, {position:"absolute", left:"0px", top:"2px", textAlign:"center", width:"22px", color:"white", fontWeight:"bold"});
        popisek.innerHTML = String.fromCharCode(char);
        znacka.appendChild(popisek);

        var options = { title:name,
                        anchor: {left:10, bottom: 1},
                        url: znacka};

        var pt = new SMap.Marker(c, null, options);
        var card = new SMap.Card();
        card.getHeader().innerHTML = "<strong>"+ name +"</strong>";
        pt.decorate(SMap.Marker.Feature.Card, card);

        coords.push(c);
        points.push(pt);
        char++;
    }

    var layer = new SMap.Layer.Marker();
    m.addLayer(layer);
    layer.enable();
    for (var i=0;i<points.length;i++) {
      layer.addMarker(points[i]);
    }

    var cz = m.computeCenterZoom(coords);
    m.setCenterZoom(cz[0], cz[1]);
  </script>
</div>
{% endblock content %}